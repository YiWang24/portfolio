# Matrix Rain Effect

## 使用方法

在终端中输入以下命令即可触发 Matrix 数字雨特效：

```bash
matrix
```

## 特性

- ✨ 使用 HTML5 Canvas 实现高性能渲染
- 🎨 半透明绿色数字雨效果（可透视背景）
- ⏱️ **5秒自动退出**
- ⌨️ 按任意键或点击鼠标可立即退出
- 🔄 自动适配屏幕尺寸
- 🌊 流畅的字符下落效果
- 💫 **雨滴拖尾效果** - 每列8个字符渐变

## 技术实现

### 1. 状态管理
- 使用 Zustand 管理全局状态
- 文件: `src/store/ui-store.ts`

### 2. 核心组件
- MatrixRain 组件使用 Canvas 2D API 绘制
- 文件: `src/components/effects/MatrixRain.tsx`

### 3. 命令处理
- matrix 命令已添加到本地命令处理器
- 文件: `src/lib/command-processor.ts`

### 4. 触发逻辑
- TerminalPanel 组件处理命令触发
- 延迟 800ms 后显示特效，让用户看到提示信息

## 视觉效果

### 密集度设置
- **字体大小**: 14px（平衡大小和密度）
- **雨滴效果**: 每列8个字符同时显示（形成拖尾）
- **字符密度**: 相比单字符提升700%
- **渐变亮度**: 头部字符100%亮度，尾部逐渐变暗

### 透明度设置
- **字符不透明度**: 70% (`rgba(0, 255, 0, 0.7)`) - 清晰可见
- **背景**: 完全透明，可看到后面的页面内容
- **流畅度**: 60fps 高帧率动画

### 初始化效果
- **全屏字符雨**: 从屏幕上方不同高度随机位置开始下落
- **错落感**: 每列字符的起始位置随机，营造自然效果
- **持续下落**: 字符从屏幕上方源源不断落下

### 阻塞体验
- **运行中提示**: 显示 `>> Matrix running...`
- **输入锁定**: Matrix 运行期间无法输入新命令
- **输入框隐藏**: 特效运行时输入框自动隐藏
- **状态更新**: 5秒后更新为完成状态消息

### 字符集
混合使用片假名 (Katakana) 和拉丁字母数字，还原原版效果：
- 日本片假名: アァカサタナハマヤャラワガザダバパ...
- 大写字母: ABCDEFGHIJKLMNOPQRSTUVWXYZ
- 数字: 0123456789

## 性能优化

- 使用 `requestAnimationFrame` 实现丝滑流畅动画
- **刷新率**: 60fps (每秒 60 帧)
- **帧间隔**: 约 16.67ms
- 自动清理定时器和动画帧，避免内存泄漏
- 优化的边界检查，只绘制屏幕内的字符

## 退出方式

1. **自动退出**: 5秒后自动消失
2. **手动退出**:
   - 点击鼠标任意位置
   - 按键盘任意键
3. 自动响应窗口大小变化

## 用户体验流程

1. 用户输入 `matrix` 命令并回车
2. **立即触发**:
   - 绿色字符雨立即覆盖整个屏幕
   - **同时显示所有提示信息**:
     ```
     >> Entering the Matrix...
     >> (Auto-exit in 5 seconds or press any key to exit)
     ```
   - **输入框消失**，进入阻塞状态
3. **运行中体验**:
   - 14px 字符，清晰可见
   - 每列8个字符形成拖尾效果
   - 头部字符亮，尾部逐渐变暗
   - 从屏幕上方不同高度开始下落
   - 60fps 丝滑流畅动画
   - 可以透视看到背后的页面内容
   - **无法输入新命令**（阻塞感）
4. **5秒后自动结束**:
   - 字符雨消失
   - **输入框重新出现**
   - 可以继续输入新命令
5. 用户也可按任意键/点击立即退出
